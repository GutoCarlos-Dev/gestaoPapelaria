<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Produtos - Leka Artes</title>
    <style>
        body { font-family: Arial, sans-serif; margin: 0; padding: 0; background-color: #f4f4f4; color: #333; }
        header { background-color: #fff; padding: 20px; display: flex; justify-content: space-between; align-items: center; box-shadow: 0 2px 5px rgba(0,0,0,0.1); }
        nav { display: flex; gap: 20px; }
        nav a { text-decoration: none; color: #333; font-weight: bold; }
        nav a:hover { color: #007bff; }
        .container { padding: 20px; }
        .actions { display: flex; gap: 10px; margin-bottom: 20px; flex-wrap: wrap; }
        button { padding: 10px 15px; background-color: #28a745; color: #fff; border: none; border-radius: 4px; cursor: pointer; }
        button:hover { background-color: #218838; }
        .btn-secondary { background-color: #007bff; }
        .btn-secondary:hover { background-color: #0056b3; }
        .btn-warning { background-color: #ffc107; color: #212529; }
        .btn-warning:hover { background-color: #e0a800; }
        .btn-danger { background-color: #dc3545; }
        .btn-danger:hover { background-color: #c82333; }
        .search-bar { margin-bottom: 20px; }
        input[type="text"] { padding: 8px; width: 300px; border: 1px solid #ddd; border-radius: 4px; }
        .product-grid { display: grid; grid-template-columns: repeat(auto-fill, minmax(300px, 1fr)); gap: 20px; }
        .product-card { background-color: #fff; border-radius: 8px; box-shadow: 0 2px 5px rgba(0,0,0,0.1); overflow: hidden; }
        .product-image { width: 100%; height: 200px; background-color: #f8f9fa; display: flex; align-items: center; justify-content: center; color: #6c757d; font-size: 48px; }
        .product-info { padding: 15px; }
        .product-name { font-size: 18px; font-weight: bold; margin-bottom: 5px; }
        .product-price { font-size: 16px; color: #28a745; font-weight: bold; margin-bottom: 10px; }
        .product-stock { font-size: 14px; margin-bottom: 10px; }
        .stock-low { color: #dc3545; }
        .stock-normal { color: #28a745; }
        .product-actions { display: flex; gap: 5px; flex-wrap: wrap; }
        .product-actions button { padding: 5px 10px; font-size: 12px; }
        .modal { display: none; position: fixed; top: 0; left: 0; width: 100%; height: 100%; background-color: rgba(0,0,0,0.5); z-index: 1000; }
        .modal-content { background-color: #fff; margin: 5% auto; padding: 20px; border-radius: 8px; width: 90%; max-width: 600px; max-height: 80vh; overflow-y: auto; }
        form { display: flex; flex-direction: column; }
        label { margin-bottom: 5px; font-weight: bold; }
        input, select, textarea { padding: 8px; margin-bottom: 15px; border: 1px solid #ddd; border-radius: 4px; }
        .form-row { display: flex; gap: 10px; }
        .form-row > * { flex: 1; }
        .alert { padding: 10px; border-radius: 4px; margin-bottom: 20px; }
        .alert-warning { background-color: #fff3cd; color: #856404; border: 1px solid #ffeaa7; }
        .alert-success { background-color: #d4edda; color: #155724; border: 1px solid #c3e6cb; }
        .tabs { display: flex; margin-bottom: 20px; }
        .tab { padding: 10px 20px; background-color: #f8f9fa; border: none; cursor: pointer; border-radius: 4px 4px 0 0; }
        .tab.active { background-color: #fff; border-bottom: 2px solid #007bff; }
        .tab-content { display: none; }
        .tab-content.active { display: block; }
        .stats-grid { display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 20px; margin-bottom: 20px; }
        .stat-card { background-color: #fff; padding: 20px; border-radius: 8px; box-shadow: 0 2px 5px rgba(0,0,0,0.1); text-align: center; }
        .stat-value { font-size: 2em; font-weight: bold; color: #007bff; }
    </style>
</head>
<body>

    <!-- Header - Cabeçalho com navegação para outras seções do sistema -->
    <header>
        <h1>Leka Artes - Controle de Produtos</h1>
        <nav>
            <!-- Menu de navegação para acessar diferentes módulos do sistema -->
            <a href="index.html">Home</a>
            <a href="dashboard.html">Dashboard</a>
            <a href="pedidos.html">Pedidos</a>
            <a href="financeiro.html">Financeiro</a>
            <a href="clientes.html">Clientes</a>
            <a href="produtos.html">Produtos</a>
            <a href="catalogo.html">Catálogo</a>
            <a href="suporte.html">Suporte</a>
            <a href="login.html">Sair</a>
        </nav>
    </header>

    <!-- Container principal da página de produtos -->
    <div class="container">

        <!-- Abas para diferentes seções de controle de produtos -->
        <div class="tabs">
            <!-- Aba de visualização em grid -->
            <button class="tab active" onclick="abrirAba('grid')">Visualização em Grid</button>
            <!-- Aba de controle de estoque -->
            <button class="tab" onclick="abrirAba('estoque')">Controle de Estoque</button>
            <!-- Aba de estatísticas -->
            <button class="tab" onclick="abrirAba('estatisticas')">Estatísticas</button>
        </div>

        <!-- Conteúdo da aba de visualização em grid -->
        <div id="grid" class="tab-content active">

            <!-- Barra de pesquisa e ações -->
            <div class="actions">
                <!-- Campo de pesquisa por nome do produto -->
                <div class="search-bar">
                    <input type="text" id="searchInput" placeholder="Buscar produto por nome..." onkeyup="filtrarProdutos()">
                </div>
                <!-- Botão para adicionar novo produto -->
                <button onclick="abrirModal('novoProduto')">Novo Produto</button>
                <!-- Botão para importar produtos -->
                <button class="btn-secondary" onclick="importarProdutos()">Importar CSV</button>
                <!-- Botão para exportar produtos -->
                <button class="btn-secondary" onclick="exportarProdutos()">Exportar CSV</button>
            </div>

            <!-- Grid de produtos - Exibe produtos em formato de cards -->
            <div class="product-grid" id="productGrid">
                <!-- Cards de produtos serão inseridos dinamicamente pelo JavaScript -->
            </div>

        </div>

        <!-- Conteúdo da aba de controle de estoque -->
        <div id="estoque" class="tab-content">

            <h2>Controle de Estoque Automático</h2>

            <!-- Alertas de estoque baixo -->
            <div id="alertasEstoque">
                <!-- Alertas serão inseridos dinamicamente -->
            </div>

            <!-- Tabela de controle de estoque -->
            <table id="estoqueTable" style="width: 100%; border-collapse: collapse; background-color: #fff; border-radius: 8px; overflow: hidden; box-shadow: 0 2px 5px rgba(0,0,0,0.1);">
                <thead>
                    <tr style="background-color: #f8f9fa;">
                        <th style="padding: 12px; text-align: left;">Produto</th>
                        <th style="padding: 12px; text-align: left;">Estoque Atual</th>
                        <th style="padding: 12px; text-align: left;">Estoque Mínimo</th>
                        <th style="padding: 12px; text-align: left;">Status</th>
                        <th style="padding: 12px; text-align: left;">Ações</th>
                    </tr>
                </thead>
                <tbody id="estoqueTableBody">
                    <!-- Linhas da tabela serão inseridas dinamicamente -->
                </tbody>
            </table>

        </div>

        <!-- Conteúdo da aba de estatísticas -->
        <div id="estatisticas" class="tab-content">

            <h2>Estatísticas de Produtos</h2>

            <!-- Cards de estatísticas -->
            <div class="stats-grid">
                <!-- Card: Total de Produtos -->
                <div class="stat-card">
                    <h3>Total de Produtos</h3>
                    <div class="stat-value" id="totalProdutos">0</div>
                    <p>Cadastrados no sistema</p>
                </div>
                <!-- Card: Produtos em Estoque Baixo -->
                <div class="stat-card">
                    <h3>Estoque Baixo</h3>
                    <div class="stat-value" id="estoqueBaixo">0</div>
                    <p>Precisam reposição</p>
                </div>
                <!-- Card: Valor Total do Estoque -->
                <div class="stat-card">
                    <h3>Valor do Estoque</h3>
                    <div class="stat-value" id="valorEstoque">R$ 0,00</div>
                    <p>Valor total investido</p>
                </div>
                <!-- Card: Produtos Mais Vendidos -->
                <div class="stat-card">
                    <h3>Mais Vendidos</h3>
                    <div class="stat-value" id="maisVendidos">Cartões</div>
                    <p>Produto mais popular</p>
                </div>
            </div>

            <!-- Gráfico de distribuição de produtos por categoria (simulado) -->
            <div style="background-color: #fff; padding: 20px; border-radius: 8px; box-shadow: 0 2px 5px rgba(0,0,0,0.1); margin-top: 20px;">
                <h3>Distribuição por Categoria</h3>
                <div style="display: flex; justify-content: space-around; align-items: end; height: 200px; margin-top: 20px;">
                    <div style="text-align: center;">
                        <div style="width: 40px; height: 120px; background-color: #007bff; margin: 0 auto 10px;"></div>
                        <span>Cartões (40%)</span>
                    </div>
                    <div style="text-align: center;">
                        <div style="width: 40px; height: 80px; background-color: #28a745; margin: 0 auto 10px;"></div>
                        <span>Banners (25%)</span>
                    </div>
                    <div style="text-align: center;">
                        <div style="width: 40px; height: 60px; background-color: #ffc107; margin: 0 auto 10px;"></div>
                        <span>Folhetos (20%)</span>
                    </div>
                    <div style="text-align: center;">
                        <div style="width: 40px; height: 40px; background-color: #dc3545; margin: 0 auto 10px;"></div>
                        <span>Outros (15%)</span>
                    </div>
                </div>
            </div>

        </div>

    </div>

    <!-- Modal para novo/editar produto - Formulário popup para gerenciar produtos -->
    <div id="modalProduto" class="modal">
        <div class="modal-content">
            <!-- Título do modal - muda dinamicamente entre "Novo Produto" e "Editar Produto" -->
            <h2 id="modalTitle">Novo Produto</h2>

            <!-- Formulário de produto - Campos para inserir dados do produto -->
            <form id="formProduto">
                <!-- Campo oculto para ID do produto (usado na edição) -->
                <input type="hidden" id="produtoId">

                <!-- Linha de campos: Nome e Categoria -->
                <div class="form-row">
                    <!-- Campo para nome do produto -->
                    <div>
                        <label for="nome">Nome do Produto:</label>
                        <input type="text" id="nome" required>
                    </div>
                    <!-- Campo para categoria do produto -->
                    <div>
                        <label for="categoria">Categoria:</label>
                        <select id="categoria" required>
                            <option value="">Selecione uma categoria</option>
                            <option value="cartoes">Cartões de Visita</option>
                            <option value="banners">Banners</option>
                            <option value="folhetos">Folhetos</option>
                            <option value="panfletos">Panfletos</option>
                            <option value="outros">Outros</option>
                        </select>
                    </div>
                </div>

                <!-- Linha de campos: Preço e Custo -->
                <div class="form-row">
                    <!-- Campo para preço de venda -->
                    <div>
                        <label for="preco">Preço de Venda (R$):</label>
                        <input type="number" id="preco" step="0.01" min="0" required>
                    </div>
                    <!-- Campo para custo do produto -->
                    <div>
                        <label for="custo">Custo (R$):</label>
                        <input type="number" id="custo" step="0.01" min="0" required>
                    </div>
                </div>

                <!-- Linha de campos: Estoque Atual e Estoque Mínimo -->
                <div class="form-row">
                    <!-- Campo para quantidade em estoque -->
                    <div>
                        <label for="estoque">Estoque Atual:</label>
                        <input type="number" id="estoque" min="0" required>
                    </div>
                    <!-- Campo para estoque mínimo -->
                    <div>
                        <label for="estoqueMinimo">Estoque Mínimo:</label>
                        <input type="number" id="estoqueMinimo" min="0" required>
                    </div>
                </div>

                <!-- Campo para descrição do produto -->
                <label for="descricao">Descrição:</label>
                <textarea id="descricao" rows="3" placeholder="Descrição detalhada do produto..."></textarea>

                <!-- Campo para status do produto -->
                <label for="statusProduto">Status:</label>
                <select id="statusProduto" required>
                    <option value="ativo">Ativo</option>
                    <option value="inativo">Inativo</option>
                </select>

                <!-- Botões do formulário -->
                <div style="display: flex; gap: 10px; justify-content: flex-end;">
                    <!-- Botão para cancelar e fechar o modal -->
                    <button type="button" onclick="fecharModal()">Cancelar</button>
                    <!-- Botão para salvar o produto -->
                    <button type="submit">Salvar Produto</button>
                </div>
            </form>
        </div>
    </div>

    <script>
        // Variável global para armazenar produtos (simulação de banco de dados)
        // Em um sistema real, esses dados viriam de uma API ou banco de dados
        let produtos = [
            { id: 1, nome: 'Cartões de Visita Standard', categoria: 'cartoes', preco: 25.00, custo: 8.00, estoque: 500, estoqueMinimo: 100, descricao: 'Cartões de visita em papel 300g, tamanho standard', status: 'ativo' },
            { id: 2, nome: 'Banner 1x2m', categoria: 'banners', preco: 150.00, custo: 45.00, estoque: 20, estoqueMinimo: 5, descricao: 'Banner em lona, tamanho 1x2m, com acabamento', status: 'ativo' },
            { id: 3, nome: 'Folhetos A5', categoria: 'folhetos', preco: 80.00, custo: 25.00, estoque: 200, estoqueMinimo: 50, descricao: 'Folhetos em papel couchê 150g, formato A5', status: 'ativo' },
            { id: 4, nome: 'Panfletos A6', categoria: 'panfletos', preco: 120.00, custo: 35.00, estoque: 15, estoqueMinimo: 10, descricao: 'Panfletos em papel couchê 200g, formato A6', status: 'ativo' },
            { id: 5, nome: 'Cartões de Visita Premium', categoria: 'cartoes', preco: 45.00, custo: 15.00, estoque: 50, estoqueMinimo: 20, descricao: 'Cartões premium em papel 350g com verniz localizado', status: 'ativo' }
        ];

        // Função para abrir abas
        // Mostra o conteúdo da aba selecionada e oculta as outras
        function abrirAba(abaId) {
            // Remover classe active de todas as abas
            document.querySelectorAll('.tab').forEach(tab => tab.classList.remove('active'));
            document.querySelectorAll('.tab-content').forEach(content => content.classList.remove('active'));

            // Adicionar classe active na aba selecionada
            event.target.classList.add('active');
            document.getElementById(abaId).classList.add('active');

            // Atualizar conteúdo específico da aba
            if (abaId === 'estoque') {
                atualizarTabelaEstoque();
            } else if (abaId === 'estatisticas') {
                atualizarEstatisticas();
            }
        }

        // Função para abrir modal de novo produto
        // Limpa o formulário e define o título apropriado
        function abrirModal(tipo) {
            document.getElementById('modalProduto').style.display = 'block';
            document.getElementById('modalTitle').textContent = tipo === 'novoProduto' ? 'Novo Produto' : 'Editar Produto';
            if (tipo === 'novoProduto') {
                limparFormulario();
            }
        }

        // Função para fechar modal
        // Oculta o modal e limpa o formulário
        function fecharModal() {
            document.getElementById('modalProduto').style.display = 'none';
            limparFormulario();
        }

        // Função para limpar formulário
        // Reseta todos os campos do formulário para valores vazios
        function limparFormulario() {
            document.getElementById('produtoId').value = '';
            document.getElementById('nome').value = '';
            document.getElementById('categoria').value = '';
            document.getElementById('preco').value = '';
            document.getElementById('custo').value = '';
            document.getElementById('estoque').value = '';
            document.getElementById('estoqueMinimo').value = '';
            document.getElementById('descricao').value = '';
            document.getElementById('statusProduto').value = 'ativo';
        }

        // Função para editar produto
        // Carrega os dados do produto no formulário para edição
        function editarProduto(id) {
            const produto = produtos.find(p => p.id === id);
            if (produto) {
                document.getElementById('produtoId').value = produto.id;
                document.getElementById('nome').value = produto.nome;
                document.getElementById('categoria').value = produto.categoria;
                document.getElementById('preco').value = produto.preco;
                document.getElementById('custo').value = produto.custo;
                document.getElementById('estoque').value = produto.estoque;
                document.getElementById('estoqueMinimo').value = produto.estoqueMinimo;
                document.getElementById('descricao').value = produto.descricao;
                document.getElementById('statusProduto').value = produto.status;
                abrirModal('editarProduto');
            }
        }

        // Função para excluir produto
        // Remove o produto da lista após confirmação do usuário
        function excluirProduto(id) {
            if (confirm('Tem certeza que deseja excluir este produto?')) {
                produtos = produtos.filter(p => p.id !== id);
                atualizarGrid();
                atualizarTabelaEstoque();
                atualizarEstatisticas();
            }
        }

        // Função para ajustar estoque
        // Permite aumentar ou diminuir o estoque manualmente
        function ajustarEstoque(id, acao) {
            const produto = produtos.find(p => p.id === id);
            if (produto) {
                const quantidade = parseInt(prompt(`Quantidade para ${acao === 'adicionar' ? 'adicionar' : 'remover'}:`));
                if (quantidade && quantidade > 0) {
                    if (acao === 'adicionar') {
                        produto.estoque += quantidade;
                    } else if (acao === 'remover' && produto.estoque >= quantidade) {
                        produto.estoque -= quantidade;
                    } else {
                        alert('Quantidade insuficiente em estoque!');
                        return;
                    }
                    atualizarGrid();
                    atualizarTabelaEstoque();
                    atualizarEstatisticas();
                }
            }
        }

        // Função para filtrar produtos
        // Filtra o grid baseado no texto digitado na busca
        function filtrarProdutos() {
            const filtro = document.getElementById('searchInput').value.toLowerCase();
            const cards = document.querySelectorAll('.product-card');

            cards.forEach(card => {
                const nome = card.querySelector('.product-name').textContent.toLowerCase();
                card.style.display = nome.includes(filtro) ? '' : 'none';
            });
        }

        // Função para atualizar grid de produtos
        // Re-renderiza o grid com os dados atuais dos produtos
        function atualizarGrid() {
            const grid = document.getElementById('productGrid');
            grid.innerHTML = '';

            produtos.forEach(produto => {
                const card = document.createElement('div');
                card.className = 'product-card';

                const estoqueStatus = produto.estoque <= produto.estoqueMinimo ? 'stock-low' : 'stock-normal';
                const estoqueTexto = produto.estoque <= produto.estoqueMinimo ? 'Estoque Baixo' : 'Estoque Normal';

                card.innerHTML = `
                    <div class="product-image">${produto.nome.charAt(0).toUpperCase()}</div>
                    <div class="product-info">
                        <div class="product-name">${produto.nome}</div>
                        <div class="product-price">R$ ${produto.preco.toFixed(2)}</div>
                        <div class="product-stock ${estoqueStatus}">Estoque: ${produto.estoque} (${estoqueTexto})</div>
                        <div class="product-actions">
                            <button onclick="editarProduto(${produto.id})">Editar</button>
                            <button class="btn-secondary" onclick="ajustarEstoque(${produto.id}, 'adicionar')">+ Estoque</button>
                            <button class="btn-warning" onclick="ajustarEstoque(${produto.id}, 'remover')">- Estoque</button>
                            <button class="btn-danger" onclick="excluirProduto(${produto.id})">Excluir</button>
                        </div>
                    </div>
                `;
                grid.appendChild(card);
            });
        }

        // Função para atualizar tabela de estoque
        // Mostra produtos com controle de estoque e alertas
        function atualizarTabelaEstoque() {
            const tbody = document.getElementById('estoqueTableBody');
            const alertas = document.getElementById('alertasEstoque');

            tbody.innerHTML = '';
            alertas.innerHTML = '';

            produtos.forEach(produto => {
                const status = produto.estoque <= produto.estoqueMinimo ? 'Crítico' : 'Normal';
                const statusClass = produto.estoque <= produto.estoqueMinimo ? 'stock-low' : 'stock-normal';

                const row = document.createElement('tr');
                row.innerHTML = `
                    <td>${produto.nome}</td>
                    <td>${produto.estoque}</td>
                    <td>${produto.estoqueMinimo}</td>
                    <td><span class="${statusClass}">${status}</span></td>
                    <td>
                        <button onclick="ajustarEstoque(${produto.id}, 'adicionar')">Repor</button>
                        <button class="btn-warning" onclick="editarProduto(${produto.id})">Ajustar</button>
                    </td>
                `;
                tbody.appendChild(row);

                // Adicionar alerta se estoque baixo
                if (produto.estoque <= produto.estoqueMinimo) {
                    const alerta = document.createElement('div');
                    alerta.className = 'alert alert-warning';
                    alerta.innerHTML = `<strong>Alerta:</strong> ${produto.nome} está com estoque baixo (${produto.estoque} unidades). Considere repor!`;
                    alertas.appendChild(alerta);
                }
            });
        }

        // Função para atualizar estatísticas
        // Calcula e exibe estatísticas dos produtos
        function atualizarEstatisticas() {
            const totalProdutos = produtos.length;
            const estoqueBaixo = produtos.filter(p => p.estoque <= p.estoqueMinimo).length;
            const valorEstoque = produtos.reduce((total, p) => total + (p.custo * p.estoque), 0);
            const maisVendido = produtos.reduce((prev, current) => (prev.estoque > current.estoque) ? prev : current);

            document.getElementById('totalProdutos').textContent = totalProdutos;
            document.getElementById('estoqueBaixo').textContent = estoqueBaixo;
            document.getElementById('valorEstoque').textContent = `R$ ${valorEstoque.toFixed(2)}`;
            document.getElementById('maisVendidos').textContent = maisVendido.nome.split(' ')[0];
        }

        // Função para importar produtos (simulado)
        // Em um sistema real, isso permitiria upload de arquivo CSV
        function importarProdutos() {
            alert('Funcionalidade de importação seria implementada aqui.\nEm um sistema real, isso permitiria fazer upload de um arquivo CSV com produtos.');
        }

        // Função para exportar produtos (simulado)
        // Em um sistema real, isso geraria um arquivo CSV para download
        function exportarProdutos() {
            alert('Funcionalidade de exportação seria implementada aqui.\nEm um sistema real, isso geraria um arquivo CSV para download com todos os produtos.');
        }

        // Event listener para submissão do formulário
        // Salva ou atualiza o produto quando o formulário é enviado
        document.getElementById('formProduto').addEventListener('submit', function(e) {
            e.preventDefault();

            const id = document.getElementById('produtoId').value;
            const nome = document.getElementById('nome').value;
            const categoria = document.getElementById('categoria').value;
            const preco = parseFloat(document.getElementById('preco').value);
            const custo = parseFloat(document.getElementById('custo').value);
            const estoque = parseInt(document.getElementById('estoque').value);
            const estoqueMinimo = parseInt(document.getElementById('estoqueMinimo').value);
            const descricao = document.getElementById('descricao').value;
            const status = document.getElementById('statusProduto').value;

            if (id) {
                // Editar produto existente
                const index = produtos.findIndex(p => p.id === parseInt(id));
                if (index !== -1) {
                    produtos[index] = { ...produtos[index], nome, categoria, preco, custo, estoque, estoqueMinimo, descricao, status };
                }
            } else {
                // Novo produto
                const novoId = Math.max(...produtos.map(p => p.id)) + 1;
                const novoProduto = {
                    id: novoId,
                    nome,
                    categoria,
                    preco,
                    custo,
                    estoque,
                    estoqueMinimo,
                    descricao,
                    status
                };
                produtos.push(novoProduto);
            }

            atualizarGrid();
            atualizarTabelaEstoque();
            atualizarEstatisticas();
            fecharModal();
        });

        // Inicializar página com dados
        window.addEventListener('load', function() {
            atualizarGrid();
            atualizarTabelaEstoque();
            atualizarEstatisticas();
        });
    </script>

</body>
</html>
